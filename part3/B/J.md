考虑一个方案占据的两边被切割为 $a,b,c,d$，那么四边形的面积就是

$$
(a+b)(c+d)-ac-bd=ad+bc
$$

所以方案数就是 $\sum_k d(k)d(n-k)$，其中 $d(n)$ 是因子数量，我们做一遍卷积就可以了，因为 $q$ 很小所以代码写的是 $O(n\log n + qn)$ 的暴力。