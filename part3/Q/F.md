实际上这就是创建了若干个变量之后给了若干个大小关系。我们考虑先把环缩点，剩下的强连通分量如果有 $k$ 个，那么实际上复杂度就是 $O(n^k)$ 的，常数项等价于有多少种大小关系的排列，也就是这个 DAG 的拓扑序数量。我们做一个 $O(k2^k)$ 的状压 DP 就行了。