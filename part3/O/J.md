我们考虑从大到小加边，那么根据 MST 的性质我们最多顶掉一条边，用一个可持久化树维护当前的边权集合就可以做到查询区间了。复杂度 $O(m\log m)$。
