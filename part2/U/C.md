数据范围只有 $2000$，所以我们首先枚举所有 $s$ 的子串的复杂度是可以接受的。我们需要注意到如果枚举区间 $[l, r]$ 的话，需要保证这个子串实际上第一个出现位置就在这里。所以我们需要做一个去重。考虑从右到左扫描所有等长区间，通过字符串哈希就容易处理每个位置的子串是不是第一个出现，以及它去掉后下一个串的出现位置。注意到我们得到子串长度 $l$ 和出现次数 $c$ 后，它要替换的目标已经唯一确定了。因为我们假设目标串长是 $l'$，那么就有 $|s| - lc = |t| - l'c$，并且我们已经知道了串的第一个出现位置。接下来我们考虑以 $O(c)$ 的复杂度暴力计算替换后的字符串哈希值，因为实际上 $c$ 次操作可以看做若干个区间的贡献，而总共的区间出现次数还是 $O(n^2)$ 次，所以复杂度还是 $O(n^2)$。
