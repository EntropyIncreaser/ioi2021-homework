我们考虑解决一个最大的 $d_i$，当它在时刻 $i$ 解决之后，所有包含 $i$ 的段都被解决了，因此问题被拆分成 $[l,i-1]$ 和 $[i+1,r]$ 子区间的问题。那么我们只需做这个区间 DP 就是 $O(n^3)$ 的了。