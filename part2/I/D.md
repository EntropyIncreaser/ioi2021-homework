注意到这是个平面图，所以我们考虑选取一条边进行分治。因为三角剖分图任取一条边都是割边，我们只需给两个端点分别跑一个 BFS 最短路，然后所有询问点对都可以用这个信息更新一下答案。那么这就是一个 $T(n) = T(\alpha n) + T((1-\alpha)n)+O(n)$ 的分治算法了，此外要加上每个询问所占据的位置。但是这个分治真的足够平衡吗？考虑我们任选一个三角形 $\alpha + \beta + \gamma=1$，根据鸽笼原理可得必有一者 $\ge \frac 13$，我们总是不必选钝角三角形所以有 $\alpha, \beta, \gamma\le \frac 12$。因此分治的层数不超过 $\log_{3/2}n + O(1)$ 层。综上，复杂度为 $O((n+q)\log n)$。
